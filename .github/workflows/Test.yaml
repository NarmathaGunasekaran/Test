name: Dynatrace Test Event

on:
  workflow_dispatch:   # allows manual trigger

jobs: 
  send-event:
    runs-on: ubuntu-latest
    steps:
      - name: Send test event to Dynatrace
        run: |
          curl -X POST "https://jvc12148.live.dynatrace.com/api/v2/apiTokens" -H "accept: application/json; charset=utf-8" -H "Content-Type: application/json; charset=utf-8" -d "{\"name\":\"Test\",\"scopes\":[\"events.ingest\"]}" -H "Authorization: Api-Token XXXXXXXX" 
          '{
                  "eventType": "CUSTOM_DEPLOYMENT",
                  "title": "GitHub â†’ Dynatrace Test",
                  "properties": {
                    "repository": "${{ github.repository }}",
                    "workflow": "${{ github.workflow }}",
                    "run_id": "${{ github.run_id }}",
                    "status": "success"
                  }
                }'
